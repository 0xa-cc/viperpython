# -*- coding: utf-8 -*-
# @File  : Vulnerability.py
# @Date  : 2019/3/8
# @Desc  :


from Core.core import Host
from Core.lib import logger
from PostLateral.postlateral import Vulnerability as postVulnerability


class Vulnerability(object):
    def __init__(self):
        pass

    @staticmethod
    def add_vulnerability(hid_or_ipaddress=None, source_module_loadpath='', extra_data=None, desc=''):
        if extra_data is None:
            extra_data = {}
        if isinstance(extra_data, dict) is not True:
            logger.warning('数据类型检查错误,数据 {}'.format(extra_data))
            extra_data = {}
        if isinstance(hid_or_ipaddress, int):
            result = postVulnerability.add_or_update(hid_or_ipaddress, source_module_loadpath, extra_data, desc)
            return result
        elif isinstance(hid_or_ipaddress, str):

            result = postVulnerability.add_or_update(Host.get_by_ipaddress(hid_or_ipaddress).get('id'),
                                                     source_module_loadpath,
                                                     extra_data, desc)
            return result
